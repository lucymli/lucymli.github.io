<!DOCTYPE html>
<html>
<head>
  <title>Epidemiological inference in the presence of superspreading using both incidence time series and pathogen phylogeny</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2016-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Epidemiological inference in the presence of superspreading using both incidence time series and pathogen phylogeny',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Lucy Li' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

  </style>

  <link rel="stylesheet" href="style.css" type="text/css" />


</head>

<body style="opacity: 0">

<slides>

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">12 September 2016</p>
          </hgroup>
  </slide>

<slide class=''><hgroup><h2>Timeline</h2></hgroup><article  id="timeline">

<ul>
<li><p>Biology BSc at Imperial College London (2009-2012) <!-- + Thesis: ￼The predictive power of R* in a two-predator one-prey Lotka-Volterra model --> <br><br></p></li>
<li><p>Computational Biology MPhil at University of Cambridge (2012-2013) <!-- + Thesis: Domain-aware protein orthology inference --> <br><br></p></li>
<li>PhD in Infectious Disease Epidemiology at Imperial College London (2013 - present)

<ul>
<li>Phylodynamic inference with application to poliovirus</li>
</ul></li>
</ul>

<!-- Research Interests: -->

<!-- - Using genetic data to understand the epidemiology of acute infectious diseases -->

<!-- - Statistical inference using particle filtering methods -->

<!-- - Data visualisation and reproducible research (R Markdown proponent) -->

</article></slide><slide class=''><hgroup><h2>Overview</h2></hgroup><article  id="overview">

<!-- Aim: Estimate epidemiological parameters for a sparsely sampled outbreak using both incidence time series and pathogen phylogeny -->

<ol>
<li>Epidemiological inference for sparsely sampled outbreaks

<ul>
<li>Using epidemiologic data, pathogen phylogenies, or both</li>
</ul></li>
<li>Superspreading and parameter inference</li>
<li>Particle MCMC framework</li>
<li>Simulation results</li>
<li>Polio</li>
</ol>

<!-- 1. Bayesian inference: Particle MCMC approach to estimate parameters for nonlinear models -->

<!-- 2. Superspreading: Importance of considering the offspring distribution -->

<!-- 3. Phylodynamics: Coalescent likelihood with arbitrary offspring distribution -->

<!-- 4. Simulation results -->

<!-- 5. Polio phylodynamics -->

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>1. Epidemiological inference for sparsely sampled outbreaks</h2></hgroup><article  id="epidemiological-inference-for-sparsely-sampled-outbreaks">

</article></slide><slide class=''><hgroup><h2>Bayesian parameter inference</h2></hgroup><article  id="bayesian-parameter-inference">

<p>Overall aim: obtain posterior estimates of epidemiological parameters</p>

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/bayes_infer_posterior-1.png' title=''/><!-- --></p>

<!-- many parameters not empirically measurable. Need to be inferred. Especially true if most infections are not observed. -->

</article></slide><slide class=''><hgroup><h2>Likelihood calculation</h2></hgroup><article  id="likelihood-calculation">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/inference_plot-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Plug-and-play inference</h2></hgroup><article  id="plug-and-play-inference">

<ul>
<li>Explicit likelihood \(P(\) parameter \(| data)\) often not available</li>
<li>Instead estimate \(P(\) parameter, traj \(| data)\) by separating epidemic simulation and likelihood calculation (Ionides et al., 2006)</li>
<li>Implemented in R package \(pomp\) (King et al., 2016)</li>
<li>Inefficient if model is highly stochastic (more on this later)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Epidemiological inference from phylogenetic data using the coalescent</h2></hgroup><article  id="epidemiological-inference-from-phylogenetic-data-using-the-coalescent">

<ul>
<li>\(\lambda = \frac{1}{N}\) (Kingman 1982) <!-- - $N$ is the number of infected individuals over time --> <!-- - Likelihood: $P($times to coalescent and LTT $|N)$ --></li>
<li>BEAST is the most popular phylodynamic tool (Drummond et al 2012; Bouckaert et al 2014) <!-- - Currently only implements simple, deterministic coalescent models --> <!-- - Bayesian skyline not informative of parameter values --></li>
<li>Or plug-and-play approach, e.g. Volz &amp; Pond (2014) fit stochastic SEIR model to Ebola phylogenies</li>
</ul>

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/rtree-1.png' title=''/><!-- --></p>

<!-- technically effective population size, but will get onto that later -->

</article></slide><slide class=''><hgroup><h2>Combining epidemiologic and coalescent analyses</h2></hgroup><article  id="combining-epidemiologic-and-coalescent-analyses">

<!-- - Both incidence time series and pathogen phylogenies are informative of underlying epidemiology -->

<ul>
<li>Assuming independent sampling:

<ul>
<li>\(L(\) Parameters \(\theta |\) Data \()\) = \(L(\theta\) \(|\) Epi Data \()\) \(L(\theta\) \(|\) Phylogeny \()\)</li>
</ul></li>
<li>Rasmussen et al (2011) demonstrated that using both sources of data to estimate \(R_0\) reduced uncertainty

<ul>
<li>Used particle MCMC (Andrieu et al., 2010) to calculated marginal likelihood</li>
<li>Focused on long-term epidemiological patterns (years)</li>
<li>Did not take into account heterogeneity in onward transmission</li>
</ul></li>
</ul>

<!-- Heterogeneity is important for coalescent analysis as it affects interpretation of the population size. Also it has public health implications.  -->

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>2. Superspreading and parameter inference</h2></hgroup><article  id="superspreading-and-parameter-inference">

</article></slide><slide class=''><hgroup><h2>Superspreading occurs when offspring distribution is overdispersed</h2></hgroup><article  id="superspreading-occurs-when-offspring-distribution-is-overdispersed">

<div class="columns-2">
<ul>
<li>Offspring = number of secondary infections per infected individual <!-- - Can be modelled by a negative binomial with mean $R$ and dispersion $k$ --></li>
<li>Small \(k\) (&lt; 0.5)

<ul>
<li>Few infected individuals contributing most infections</li>
<li>Consequences for control programmes</li>
<li>Increased extinction rate but potentially larger outbreaks</li>
</ul></li>
</ul>

<img src='overdispersion.pdf' title='fig:'/></div>

</article></slide><slide class=''><hgroup><h2>Estimating \(k\)</h2></hgroup><article  id="estimating-k">

<ul>
<li>Superspreading is common amongst infectious diseases (Lloyd-Smith et al., 2005)

<ul>
<li>e.g. Ebola outbreak in 2014: 0.03-0.5</li>
<li>e.g. SARS 2004: 0.1-0.6</li>
</ul></li>
<li>Difficult to quantify \(k\)

<ul>
<li>Contact tracing is difficult and potentially biased</li>
<li>Could be estimated through outbreak size distribution (Garske &amp; Rhodes, 2008), but would not work for a single outbreak</li>
</ul></li>
<li>Genetic analysis can be used to help quantify \(k\)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Coalescent: Effective population size</h2></hgroup><article  id="coalescent-effective-population-size">

<ul>
<li>\(Ne=N\) if real population like a Wright-Fisher population

<ul>
<li>Poisson distributed offspring distribution in original coalescent</li>
</ul></li>
<li>Usually \(N &gt;&gt; Ne\) <!-- - Most people do not transmit further, while a few superspreaders cause most of the infections --> <!-- - Can be modelled by a negative binomial, with mean $R_t$ and variance $R_t(1+\frac{R_t}{k})$ --></li>
<li>Need formulation of coalescent that linkes \(Ne\) with \(N\) via the offspring distribution</li>
</ul>

<p>\[ \lambda_t = \frac{1}{Ne_t} = \frac{R_t (1 + \frac{1}{k})}{N_t T_g}\]</p>

<p>(Fraser, 2016)</p>

<!-- - Coalescent provides a link between the genealogy and 'effective population size' $Ne$ (Kingman, 1982) -->

<!-- - Assuming the genealogy is known, we can use the times to coalescence to estimate the $Ne$ -->

<!-- - Skyline method: Estimate $Ne_t$ (Drummond et al, 2005) -->

<!-- - However $Ne_t \neq I_t$ (prevalence of infection) due to differences in assumptions about the offspring distribution -->

<!-- - The relationship between the time to coalescence and prevalence of infection depends on the offspring distribution and the generation time -->

<!-- - Volz et al (2009) showed that the likelihood of epidemiological parameters and an epidemic trajectory (prevalence over time) can be calculated from the genealogy -->

<!-- - However, SIR models assume a geometrically distributed offspring distributed, but epidemics tend to be more overdisperseed -->

<!-- Incorporating genetic data in epidemiological inference -->

<!-- - Contact tracing information is necessary to directly measure the overdispersion of the offspring distribution - not available for sparsely sampled diseases -->

<!-- - Overdispersion could be estimated from genetic data as it affects pathogen diversity -->

<!-- - Using population genetic models such as the coalescent, we can estimate the effective number of infections $N_e$, is related to the true number of infections via the offspring distribution  -->

<!-- \begin{align} -->

<!-- \lambda = \frac{1}{N_e} -->

<!-- \end{align} -->

<!-- \begin{itemize} -->

<!--   \item Aim: Estimate epidemiological parameters from pathogen sequences -->

<!--   \begin{itemize} -->

<!--     \item BEAST (Drummond et al 2012; Bouckaert et al 2014) approaches.  -->

<!--   \end{itemize} -->

<!--   \item Aim: Estimate epidemiological parameters from both epidemiologic data and pathogen sequences -->

<!--   \begin{itemize} -->

<!--     \item Dense sampling: Reconciling transmission tree and phylogenetic tree to track outbreaks of foot-and-mouth (Ypma et al 2013) and tuberculosis (Colijn \& Gardy 2014) -->

<!--     \item Sparse sampling: Fitting stochastic SIR models to Dengue data collected over 6 years (Rasmussen et al 2011, 2014) -->

<!--   \end{itemize} -->

<!-- \end{itemize} -->

<!-- Reproductive number is not directly measurable from data for sparsely sampled epidemics. Although can be estimated during exponential phase, but for more complex dynamics, best estimated from a model. -->

<!-- > - MCMC often used to estimate posterior distribution for each parameter $\theta$ -->

<!-- > - Requires calculation of likelihood: P(data | $\theta_i$) -->

<!-- > - Intractible likelihood for nonlinear and stochastic models -->

<!-- > - Instead, calculate $\int_x P(data | x) P(x | \theta_i)$ -->

<!-- Simulation from model an epidemic trajectory with various parameter values -->

<!-- Compare epidemic trajectory to observed time series -->

<!-- MCMC algorithm to explore parameter space and obtain posterior distribution -->

<!-- Likelihood of epidemiologic data:  -->

<!-- - $x\sim$ Binomial (I, $\rho$) -->

<!-- - I = number of new infections (reported + unreported cases) -->

<!-- - $\rho$ = reporting rate -->

<!-- \begin{align} -->

<!-- f_E(x) = \binom{N}{x} \rho^x (1-\rho)^{N-x} -->

<!-- \end{align} -->

</article></slide><slide class=''><hgroup><h2>Our work</h2></hgroup><article  id="our-work">

<!-- - Quantifying the extent of superspreading -->

<!--     - is necessary for accurate inference from phylogenetic data -->

<!--     - has implication for effectiveness of control measures -->

<ul>
<li>Build an inference framework to fit stochastic models with explicit offspring distribution to both epidemiologic and phylogenetic data</li>
<li>Assess contribution of phylogenetic data to epidemiological inference, especially with respect to quantifying \(k\)</li>
<li><p>Incorporate phylogenetic uncertainty</p></li>
<li>C++ Code: github.com/lucymli/EpiGenMCMC</li>
<li><p>R package: EpiGenR</p></li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>3. PMCMC</h2></hgroup><article  id="pmcmc">

</article></slide><slide class=''><hgroup><h2>Marginal likelihood: Integrating over stochastic outcomes</h2></hgroup><article  id="marginal-likelihood-integrating-over-stochastic-outcomes">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/marginal_plot-1.png' title=''/><!-- --></p>

<!-- Due to nonlinear dynamics, hard to write down the likelihood of parameters given data. But it's fairly trivial using an epidemic trajectories -->

</article></slide><slide class=''><hgroup><h2>Particle filtering</h2></hgroup><article  id="particle-filtering">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/particle_filtering-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Particle filtering</h2></hgroup><article  id="particle-filtering-1">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/particle_filtering2-1.png' title=''/><!-- --></p>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>4. Simulation results</h2></hgroup><article  id="simulation-results">

</article></slide><slide class=''><hgroup><h2>Simulated data</h2></hgroup><article  id="simulated-data">

<ul>
<li>SIR model with an explicit offspring distribution</li>
<li>Single index case in a wholly susceptible population with 20,000 people</li>
<li>For \(R_0=\{2, 5\}\), \(k=\{0.1, 1, 10\}\), reporting probability \(\rho=\{1\%, 10\%\}\)</li>
<li>10 replicate simulations per set of parameters</li>
<li>Inference using incidence time series, phylogeny, or both</li>
</ul>

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/method_diagram-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Genetic data most informative of \(k\)</h2></hgroup><article  id="genetic-data-most-informative-of-k">

<!-- k -->

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/largepopk-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>\(R_0\) estimates: slight reduction in uncertainty</h2></hgroup><article  id="r_0-estimates-slight-reduction-in-uncertainty">

<!-- R0  -->

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/largepopR0-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Similar estimates of epidemic start date</h2></hgroup><article  id="similar-estimates-of-epidemic-start-date">

<!-- Date of first infection -->

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/largepopstart-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Similar estimates of reporting rate</h2></hgroup><article  id="similar-estimates-of-reporting-rate">

<!-- Reporting rate -->

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/largepoprho-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Biased estimate of \(R_0\) if wrong assumption about \(k\)</h2></hgroup><article  id="biased-estimate-of-r_0-if-wrong-assumption-about-k">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/fixed_k_plots1-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Phylogenetic uncertainty</h2></hgroup><article  id="simulation-results-phylogenetic-uncertainty">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/multitree_plot-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Take-home messages</h2></hgroup><article  id="take-home-messages">

<ul>
<li>For sparsely sampled epidemics, detection of superspreading is only possible when phylogenetic data are used</li>
<li>More precise and accurate estimates of R0 were obtained when both epidemiologic and phylogenetic data were used</li>
<li>Phylogenetic uncertainty could be incorporated by repeating analysis with sampled phylogenies</li>
</ul>

<p>Current analyses:</p>

<ul>
<li>Poliovirus outbreak</li>
<li>Environmental polio surveillance</li>
<li>Ebolavirus</li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Application to poliovirus</h2></hgroup><article  id="application-to-poliovirus">

</article></slide><slide class=''><hgroup><h2>Data</h2></hgroup><article  id="data">

<ul>
<li>Over 500 reported cases of type-1 polio in Tajikistan in 2010</li>
<li>116 viral sequences were obtained (Yakovenko et al 2014)</li>
<li>Maximum likelihood parameters values were inferred using reported case time-series, with a fixed reporting rate of 1 in 200 (Blake et al 2014)</li>
</ul>

<p><br></p>

<ul>
<li>Data provided by Professor Vadim Agol and colleagues at Moscow State University and CDC</li>
</ul>

<!-- Aim:  -->

<!-- - Incorporating viral sequences in inference -->

<!-- - Estimate reporting rate and other parameters while accounting for stochasticity -->

</article></slide><slide class=''><hgroup><h2>Parameter inference</h2></hgroup><article  id="parameter-inference">

<p><img src='2016-09-12_Harvard_CCDD_files/figure-html/Tajikistan_plot-1.png' title=''/><!-- --></p>

</article></slide><slide class=''><hgroup><h2>Further work</h2></hgroup><article  id="further-work">

<p>Application to:</p>

<ul>
<li>Other poliovirus strains (e.g. cVDPV2)</li>
<li>Other acute viral infections (e.g. Ebola, influenza)</li>
<li>Within-host dynamics</li>
</ul>

<p>Extensions to the method:</p>

<ul>
<li>Estimate phylogenies alongside epidemiological parameters (like in BEAST)</li>
<li>Include more complex evolutionary processes (e.g. selection, recombination)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Acknowledgements</h2></hgroup><article  id="acknowledgements">

<div class="columns-2">
<p>Analysis:</p>

<ul>
<li>Professors Christophe Fraser and Nicholas Grassly</li>
<li>Evolutionary Epidemiology, and Vaccine Epidemiology Research Groups</li>
</ul>

<!-- Data: -->

<!-- - CDC and Professor Vadim Agol (MSU) -->

<p>Funding:</p>

<ul>
<li>MRC studentship</li>
<li>Imperial HPC resources funded by UK MED-BIO (an MRC project)</li>
</ul></div>

<center>

<img src="Imperial.png" height="20%" width="20%">                   <img src="MRC.png" height="15%" width="15%">

</center>

<p>Contact info:</p>

<ul>
<li><a href='mailto:ml3109@ic.ac.uk' title=''>ml3109@ic.ac.uk</a></li>
<li><a href='www.twitter.com/lucylmq' title=''>twitter.com/lucylmq</a></li>
<li><a href='www.github.com/lucymli' title=''>github.com/lucymli</a></li>
</ul></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/hammer.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="2016-09-12_Harvard_CCDD_files/ioslides-13.5.1/js/slide-deck.js"></script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
